{% extends "base.html" %}

{% block title %}My dance database{% endblock %}

{% block misc %}
    <script type="text/javascript">
        window.extraforms = {
            {% for move, individ_form in form_list %}
            {% spaceless %}
            {{ move }}: '<div class="subform" id="{{ move }}", style="display:inline-block">{{ individ_form }}</div>',
            {% endspaceless %}
            {% endfor %}
        };
    </script>

<script type="text/javascript" language="javascript" class="init">
    $(document).ready(function() {
        hideAll('subform'); //this won't work if there's more than one form...
        $('#id_movename')[0].setAttribute('onchange', "console.log(this); openSubforms(this.value)");
    } );

    function getFormset(obj){
        return document.getElementsByClassName(obj.attr('class'));
    }
    function hideAll(classname){
        var formset = document.getElementsByClassName(classname);

        for (i = 0; i < formset.length; i++) {
            formset[i].style.display = "none";
        }
        // update so only hides all of one class
    }

    function openSubforms(val){
        console.log(val);
        hideAll('subform');
            // should also clear all values, disable hidden forms
        // document.getElementById(val).style.display = "inline"
        // var newDiv = document.createElement('div')
        // newDiv.style.display = "inline"
        // newDiv.innerHTML = extraforms[val]
        // $('#form1').append(newDiv)
        $('#subform1').html(extraforms[val])
        // if not empty string, get appropriate form, change display style to shown
    }

    function addForm(){
        console.log("you added a form!")
    }

    function removeForm(){
        console.log("you removed a form!")
    }
</script>

<p>This is me testing a fancy search thing.</p>

<p>
<form action="testresults" method="get">
    {% csrf_token %}
    <div id="form1">{{ form }}
        <div id="subform1" style="display: inline"></div>
    </div>
    <input type="button" value="+" onclick="addForm()">
    <input type="button" value="-" onclick="removeForm()">
    <input type="submit" value="Submit" />
</form>
</p>
{% endblock %}